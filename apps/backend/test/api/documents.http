### Test de l'API Documents - Upload et gestion de fichiers
### Base URL
@baseUrl = http://localhost:4000
@documentsUrl = {{baseUrl}}/documents

### Variables pour les tests
@companyId = 9844a181-34be-40a5-808a-11107b4cb248
@documentId = 9995573a-577a-474e-9d81-9276dbc579aa

### ðŸ“¤ 1. UPLOAD - Document PDF valide (avec un vrai fichier)
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundary123

--boundary123
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundary123
Content-Disposition: form-data; name="type"

financial
--boundary123
Content-Disposition: form-data; name="description"

Bilan financier 2024
--boundary123
Content-Disposition: form-data; name="file"; filename="pdf-test.pdf"

< C:/Users/Mehmet.Cinar/Downloads/pdf-test.pdf
--boundary123--

### ðŸ“¤ 2. UPLOAD - Document image valide
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundary456

--boundary456
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundary456
Content-Disposition: form-data; name="type"

identity
--boundary456
Content-Disposition: form-data; name="file"; filename="statuts.jpg"
Content-Type: image/jpeg

JPEG fake content
--boundary456--

### ðŸ“¤ 3. UPLOAD - Document Excel
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundary789

--boundary789
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundary789
Content-Disposition: form-data; name="type"

tax
--boundary789
Content-Disposition: form-data; name="file"; filename="declarations-tva.xlsx"
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

Excel fake content
--boundary789--

### âŒ 4. UPLOAD - Fichier trop volumineux (doit Ã©chouer)
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundaryBig

--boundaryBig
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundaryBig
Content-Disposition: form-data; name="type"

other
--boundaryBig
Content-Disposition: form-data; name="file"; filename="huge-file.pdf"
Content-Type: application/pdf

< C:/Users/Mehmet.Cinar/Downloads/big-file.pdf
--boundaryBig--

### âŒ 5. UPLOAD - Type de fichier non autorisÃ© (doit Ã©chouer)
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundaryBad

--boundaryBad
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundaryBad
Content-Disposition: form-data; name="type"

other
--boundaryBad
Content-Disposition: form-data; name="file"; filename="virus.exe"
Content-Type: application/octet-stream

Fake executable content
--boundaryBad--

### âŒ 6. UPLOAD - Entreprise inexistante (doit Ã©chouer)
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundaryNoComp

--boundaryNoComp
Content-Disposition: form-data; name="companyId"

99999999-9999-9999-9999-999999999999
--boundaryNoComp
Content-Disposition: form-data; name="type"

other
--boundaryNoComp
Content-Disposition: form-data; name="file"; filename="test.pdf"
Content-Type: application/pdf

PDF content
--boundaryNoComp--

### ðŸ“‹ 7. GET - Liste tous les documents (avec pagination)
GET {{documentsUrl}}

### ðŸ“‹ 8. GET - Liste avec filtres et pagination
GET {{documentsUrl}}?page=1&limit=5&type=financial&status=pending

### ðŸ“‹ 9. GET - Recherche par nom de fichier
GET {{documentsUrl}}?search=bilan&limit=10

### ðŸ“‹ 10. GET - Documents d'une entreprise spÃ©cifique
GET {{documentsUrl}}/company/{{companyId}}

### ðŸ“‹ 11. GET - DÃ©tails d'un document spÃ©cifique
GET {{documentsUrl}}/{{documentId}}

### ðŸ“Š 12. GET - Statistiques des documents
GET {{documentsUrl}}/stats

### ðŸ“Š 13. GET - Statistiques pour une entreprise spÃ©cifique
GET {{documentsUrl}}/stats?companyId={{companyId}}

### ðŸ“¥ 14. GET - TÃ©lÃ©charger un document
GET {{documentsUrl}}/{{documentId}}/download

### ðŸ‘ï¸ 15. GET - AperÃ§u d'un document (dans le navigateur)
GET {{documentsUrl}}/{{documentId}}/preview

### âœï¸ 16. PATCH - Mettre Ã  jour le statut d'un document
PATCH {{documentsUrl}}/{{documentId}}
Content-Type: application/json

{
  "status": "processed",
  "description": "Document traitÃ© et validÃ©"
}

### âœï¸ 17. PATCH - Marquer comme archivÃ©
PATCH {{documentsUrl}}/{{documentId}}
Content-Type: application/json

{
  "status": "archived"
}

### âŒ 18. PATCH - Mettre Ã  jour avec un statut invalide (doit Ã©chouer)
PATCH {{documentsUrl}}/{{documentId}}
Content-Type: application/json

{
  "status": "invalid_status"
}

### ðŸ—‘ï¸ 19. DELETE - Supprimer un document (fichier + BDD)
DELETE {{documentsUrl}}/{{documentId}}

### âŒ 20. DELETE - Supprimer un document inexistant (doit Ã©chouer)
DELETE {{documentsUrl}}/99999999-9999-9999-9999-999999999999

### Tests de cas limites et validation

### ðŸ“¤ 21. UPLOAD - Nom de fichier avec caractÃ¨res spÃ©ciaux
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundarySpecial

--boundarySpecial
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundarySpecial
Content-Disposition: form-data; name="type"

administrative
--boundarySpecial
Content-Disposition: form-data; name="file"; filename="document-Ã Ã§Ã©Ã±_ç‰¹æ®Šå­—ç¬¦.pdf"
Content-Type: application/pdf

PDF content with special filename
--boundarySpecial--

### ðŸ“¤ 22. UPLOAD - Tous les types de documents supportÃ©s
POST {{documentsUrl}}/upload
Content-Type: multipart/form-data; boundary=boundaryTypes

--boundaryTypes
Content-Disposition: form-data; name="companyId"

{{companyId}}
--boundaryTypes
Content-Disposition: form-data; name="type"

legal
--boundaryTypes
Content-Disposition: form-data; name="file"; filename="contrat.docx"
Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document

DOCX content
--boundaryTypes--

### ðŸ“‹ 23. GET - Test pagination extrÃªme
GET {{documentsUrl}}?page=999&limit=1

### ðŸ“‹ 24. GET - Test avec tous les filtres combinÃ©s
GET {{documentsUrl}}?companyId={{companyId}}&type=financial&status=processed&search=bilan&page=1&limit=20

### âŒ 25. GET - Document inexistant (doit Ã©chouer)
GET {{documentsUrl}}/99999999-9999-9999-9999-999999999999

### Notes d'utilisation :
### 
### ðŸ”§ Configuration requise :
### 1. Serveur backend dÃ©marrÃ© sur localhost:4000
### 2. Base de donnÃ©es avec au moins une entreprise
### 3. Variable UPLOAD_PATH configurÃ©e
### 4. Dossier d'upload existant et accessible en Ã©criture
### 
### ðŸ“ Utilisation :
### 1. Remplacez {{companyId}} par un ID d'entreprise valide
### 2. AprÃ¨s un upload rÃ©ussi, copiez l'ID du document retournÃ©
### 3. Remplacez {{documentId}} par cet ID pour les autres tests
### 4. Les tests 1-3 crÃ©ent des documents, testez-les en premier
### 5. Les tests avec âŒ sont des cas d'erreur attendus
### 
### ðŸŽ¯ Types de documents supportÃ©s :
### - identity, financial, tax, legal, administrative, other
### 
### ðŸ“ Extensions supportÃ©es :
### - Images: jpg, jpeg, png, gif
### - Documents: pdf, doc, docx, xls, xlsx, txt
### 
### ðŸ›¡ï¸ Limites :
### - Taille max: 10MB
### - Validation automatique des types MIME